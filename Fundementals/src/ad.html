<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AD</title>
</head>
<style>
    @import url('https://fonts.googleapis.com/css2?family=Comfortaa:wght@300;400;700&display=swap');

    * {
        overflow: hidden;
    }

    body {
        background-color: white;
        padding: 0;
        margin: 0;
        font-family: "Comfortaa";
    }

    img {
        width: 100%;
        height: 100%;
        position: fixed;
    }

    a {
        text-decoration: none;
        color: black;
    }
</style>
<body>
    <a href="http://btc.jgkd.dev/Fundementals/" id="link" target="_blank">
        <img id="image">
        <h1 id="text">Loading AD...</h1>
        <p id="desc">Loading...</p>
    </a>
    
</body>
<script>
    images = {
        "ageofwar2": "ageofwar2.png",
        "burgertycoon": "fastfoodtycoon.png",
        "papaspizzera": "papaspizzeria.png",
        "jacksmith": "jacksmith.png",
        "themehotel": "themehotel.png",
        "whenpizzasattack": "papalouiewhenpizzasattack.png",
        "miraginewar": "miraginewar.jpg",
        "eaglercraft": "eaglercraft.png",
        "fivenightsatwinstons": "fnaw.png",
        "slope": "slope.png",
        "crossyroad": "crossyroad.png"
    }

    ads = {
        "daveAD": {
            "image": "./ApprovedDave.jpg",
            "link": "http://btc.jgkd.dev/Fundementals/games.html?from=dave"
        },
        "mitchellAD": {
            "image": "./games/img/comingsoon.jpg",
            "link": "http://btc.jgkd.dev/Fundementals/games.html?from=mitchell"
        },
        "gzoneAD": {
            "image": './gzone.png',
            "link": 'https://btc.jgkd.dev/gzone'
        }
    }

    const colours = ['red', 'orange', 'yellow', 'green', 'blue', 'violet']
    let currentIndex = 0;

    function changingColours() {
        document.body.style.background = colours[currentIndex];
        currentIndex = (currentIndex + 1) % colours.length; 
    }

    function getCookie(cname) {
    let name = cname + "=";
    let decodedCookie = decodeURIComponent(document.cookie);
    let ca = decodedCookie.split(';');
    for (let i = 0; i < ca.length; i++) {
        let c = ca[i]
        while (c.charAt(0) == ' ') {
            c = c.substring(1);
        }
        if (c.indexOf(name) == 0) {
            return c.substring(name.length, c.length);
        }
    }
        return "";
    }   

    const queryString = window.location.search;
    const urlParams = new URLSearchParams(queryString);
    const type = urlParams.get("type");
    const width = urlParams.get("width");
    const height = urlParams.get("height");
    const specAd = urlParams.get("ad");

    let link = document.getElementById("link");
    let image = document.getElementById("image");
    let text = document.getElementById("text");
    let desc = document.getElementById("desc");

    image.style.position = "fixed";

    if (Number(height) < 350) {
        image.style.top = 0;
        image.style.right = 0;
        image.style.width = "50%";
        image.style.height = "100%";
    } else {
        image.style.bottom = 0;
        image.style.width = "100%";
        image.style.height = "50%";
    }

    document.body.style.width = width + 'px'
    document.body.style.height = height + 'px'

    let gameURL = getCookie("lastGame1");
    let searchParams = new URLSearchParams(gameURL);
    
    let name = searchParams.get('name');

    if (type=="suggested") {
        console.log(getCookie())
        if (getCookie("username") != "" && name != null) {
            imageLocation = "./games/img/" + images[name.toLocaleLowerCase()]
            console.log(imageLocation)
            image.setAttribute("src", imageLocation)
            link.setAttribute("href", gameURL)
            image.style.width = "100%";
        image.style.height = "100%";
        } else {
            text.innerHTML = "Click here to play our amazing games!"
            desc.innerHTML = "GET FREE ACCESS TODAY!"
            link.setAttribute("href", "http://btc.jgkd.dev/Fundementals/games.html?from=newUser&origin=" + window.top.location.href)
        }
    } else if (type=="hidden") {
        text.remove()
        desc.remove()
        image.remove()
        link.remove()

        document.body.style.width = '100%'
        document.body.style.height = '100%'

        let adlink = "http://btc.jgkd.dev/Fundementals/games.html?from=hidden&origin=" + window.top.location.href;
        window.location.href = adlink;
    } else {
        text.innerHTML = "Play Fun Games!"
        desc.innerHTML = "At Joe's Fun Collection!"

        const keys = Object.keys(ads);
        const randomIndex = Math.floor(Math.random() * keys.length);

        console.log(specAd)

        if (specAd != "") {
            let currentIndex = ads[specAd]
            if (specAd == "gzoneAD") {
                text.remove()
                desc.remove()

                image.style.width = "100%"
                image.style.height = "100%"

                let adlink = currentIndex["link"]

                link.setAttribute("href", adlink)
                image.setAttribute("src", currentIndex["image"])
            }
        } else {
            let currentIndex = keys[randomIndex]
            if (keys[randomIndex] == "gzoneAD")  {
                text.remove()
                desc.remove()

                image.style.width = "100%"
                image.style.height = "100%"

                console.log(currentIndex)

                let adlink = ads[currentIndex]["link"]

                link.setAttribute("href", adlink)
                image.setAttribute("src", ads[currentIndex]["image"])
            } else {
                let adlink = ads[currentIndex]["link"] + '&origin=' + window.top.location.href;

                console.log(adlink)

                image.setAttribute("src", ads[currentIndex]["image"])
                link.setAttribute("href", adlink)
                
                const iterval = setInterval(changingColours, 500);
            }
        }    
    }

    

</script>
</html>